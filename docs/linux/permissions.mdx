---
sidebar_position: 4
---

# 理解 Linux 文件权限：读、写、执行

在 Linux 这个多用户的操作系统中，权限系统是确保系统安全和数据隔离的核心机制。它决定了谁可以对文件和目录做什么操作。如果你曾对 `ls -l` 命令输出结果中那串神秘的 `rwx` 字符感到困惑，那么本教程将为你揭开它的面纱。

## 权限的基本概念

在 Linux 中，每个文件和目录都关联着三类所有者：

1.  **用户（User）**: 文件或目录的所有者，通常是创建它的人。
2.  **用户组（Group）**: 文件或目录所属的用户组。一个用户组可以包含多个用户。这是一种协作机制，允许组内成员共享文件访问权限。
3.  **其他（Others）**: 既不是文件所有者，也不属于文件所属用户组的任何其他用户。

针对这三类所有者，有三种基本的操作权限：

1.  **读（Read, `r`）**:
    -   对于文件：可以读取文件的内容。
    -   对于目录：可以列出目录中包含的文件和子目录（即使用 `ls` 命令）。
2.  **写（Write, `w`）**:
    -   对于文件：可以修改文件的内容。
    -   对于目录：可以在目录中创建、删除、重命名文件和子目录。**（注意：删除文件需要对该文件所在的目录有写权限，而不是对文件本身有写权限）**
3.  **执行（Execute, `x`）**:
    -   对于文件：可以作为程序来执行。对于脚本（如 Shell 脚本、Python 脚本）来说，这是必须的。
    -   对于目录：可以进入（`cd`）该目录。如果没有执行权限，你甚至无法访问目录内的任何内容，即使你拥有读权限。

## 解读 `ls -l` 的输出

让我们通过 `ls -l` 命令来直观地理解权限。

```bash
$ ls -l my_script.sh
-rwxr-x--x 1 tamochii developers 1024 Nov 13 15:30 my_script.sh
```

这行输出包含了丰富的信息，我们来逐一分解：

` -  rwx  r-x  --x `

这 10 个字符的权限描述符可以分为四个部分：

1.  **第 1 位：文件类型**
    -   `-`: 普通文件
    -   `d`: 目录
    -   `l`: 符号链接（Symbolic Link）
    -   其他还有 `c` (字符设备), `b` (块设备) 等。

2.  **第 2-4 位：所有者（User）的权限**
    -   `rwx`: 表示所有者 `tamochii` 拥有对该文件的**读、写、执行**权限。

3.  **第 5-7 位：所属组（Group）的权限**
    -   `r-x`: 表示 `developers` 组的成员拥有**读、执行**权限，但没有**写**权限（由 `-` 表示）。

4.  **第 8-10 位：其他人（Others）的权限**
    -   `--x`: 表示其他用户只拥有**执行**权限，没有读和写权限。

剩下的部分：
- `1`: 硬链接数。
- `tamochii`: 文件所有者。
- `developers`: 文件所属的用户组。
- `1024`: 文件大小（字节）。
- `Nov 13 15:30`: 最后修改时间。
- `my_script.sh`: 文件名。

## 修改权限：`chmod` 命令

`chmod` (Change Mode) 命令用于修改文件或目录的权限。它有两种主要的使用方式：符号模式和八进制模式。

### 1. 符号模式 (Symbolic Mode)

这种方式更直观，易于理解。基本语法是 `chmod [who][operator][permission] file`。

- **`who` (谁)**:
  - `u`: 用户 (user)
  - `g`: 用户组 (group)
  - `o`: 其他人 (others)
  - `a`:所有人 (all)，等同于 `ugo`

- **`operator` (操作符)**:
  - `+`: 添加权限
  - `-`: 移除权限
  - `=`: 设置权限（覆盖原有权限）

- **`permission` (权限)**:
  - `r`: 读
  - `w`: 写
  - `x`: 执行

**示例：**

```bash
# 给所有者添加执行权限
$ chmod u+x my_script.sh

# 移除其他人（others）的写权限
$ chmod o-w some_file.txt

# 让用户组（group）和所有人（others）都只有读权限
$ chmod go=r another_file.txt

# 给所有人添加读权限
$ chmod a+r public_file.txt

# 递归地为一个目录及其所有内容移除其他人的写权限
$ chmod -R o-w my_project/
```

### 2. 八进制模式 (Octal Mode)

这种方式更简洁，在熟练后效率更高。它使用数字来代表权限组合。

- `r` = 4
- `w` = 2
- `x` = 1
- `-` = 0

将每组（User, Group, Others）的权限数字相加，得到一个三位数的八进制数。

- `rwx` = 4 + 2 + 1 = **7**
- `rw-` = 4 + 2 + 0 = **6**
- `r-x` = 4 + 0 + 1 = **5**
- `r--` = 4 + 0 + 0 = **4**
- `--x` = 0 + 0 + 1 = **1**

**示例：**

假设我们想设置权限为 `-rwxr-x--x`，分解如下：
- User: `rwx` -> 7
- Group: `r-x` -> 5
- Others: `--x` -> 1

所以对应的命令就是：
```bash
$ chmod 751 my_script.sh
```

**常用权限组合：**
- `777`: `rwxrwxrwx` - 所有人都有所有权限。**（非常危险，应避免使用）**
- `755`: `rwxr-xr-x` - 所有者可读写执行，其他人可读可执行。常用于**目录和程序**。
- `644`: `rw-r--r--` - 所有者可读写，其他人只能读。常用于**普通文件**。
- `600`: `rw-------` - 只有所有者可读写。常用于**私密文件**。

## 修改所有权：`chown` 和 `chgrp`

- **`chown` (Change Owner)**: 修改文件或目录的所有者和用户组。
  ```bash
  # 将文件所有者改为 bob
  $ sudo chown bob some_file.txt

  # 同时改变所有者和用户组
  $ sudo chown bob:editors some_file.txt
  ```

- **`chgrp` (Change Group)**: 只修改文件或目录的用户组。
  ```bash
  $ sudo chgrp developers another_file.txt
  ```
  *注意：修改所有权通常需要 `sudo` 权限。*

## 结语

掌握 Linux 的权限系统是成为一名合格的 Linux 用户的必经之路。它不仅能保护你的文件不被意外修改或删除，也是保障整个系统安全的关键。

现在，当你再次使用 `ls -l` 时，你将不再对那串字符感到陌生，而是能够清晰地洞察每个文件和目录的安全状态。在后续的教程中，我们将学习如何管理用户和用户组，进一步深化对权限系统的理解。
